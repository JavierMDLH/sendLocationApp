<!DOCTYPE html>
<html>
<head>
    <title>Últimos datos recibidos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.2/socket.io.js"></script>
</head>
<body>
    <h1>Últimos datos recibidos:</h1>
    <p>Latitud: <span id="latitud"></span></p>
    <p>Longitud: <span id="longitud"></span></p>
    <p>Altitud: <span id="altitud"></span></p>
    <p>Timestamp: <span id="timestamp"></span></p>

    <script>
        const socket = io.connect('http://' + document.domain + ':' + location.port);
    
        socket.on('connect', function() {
            console.log('Conectado al servidor WebSocket');
        });
    
        socket.on('disconnect', function() {
            console.log('Desconectado del servidor WebSocket');
        });


        const timeZoneOffsetHours = 5; // Ajusta el offset de la zona horaria según sea necesario
        // Función para formatear la fecha con zona horaria ajustada
        function formatDateWithTimeZone(timestamp, timeZoneOffsetHours) {
            const date = new Date(timestamp);
            const adjustedDate = new Date(date.getTime() + (timeZoneOffsetHours * 60 * 60 * 1000));
            
            const year = adjustedDate.getFullYear();
            const month = String(adjustedDate.getMonth() + 1).padStart(2, '0');
            const day = String(adjustedDate.getDate()).padStart(2, '0');
            const hours = String(adjustedDate.getHours()).padStart(2, '0');
            const minutes = String(adjustedDate.getMinutes()).padStart(2, '0');
            const seconds = String(adjustedDate.getSeconds()).padStart(2, '0');
            
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }

    
        socket.on('update_data', function(data) {
            console.log('Datos actualizados recibidos:', data);
            updateDataOnPage(data);
        });
    
        function updateDataOnPage(data) {
            console.log('Actualizando datos en la página:', data);
            document.getElementById('latitud').innerText = data[0];
            document.getElementById('longitud').innerText = data[1];
            document.getElementById('altitud').innerText = data[2];
            console.log('Timestamp antes de formatear:', data[3]);
            document.getElementById('timestamp').innerText = formatDate(data[3]);
        }
    </script>
</body>
</html>